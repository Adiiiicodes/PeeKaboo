<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PeeKaboo</title>
  <link rel="stylesheet" href="styles.css"> <!-- Link to the external CSS file -->
</head>
<body>
  <div class="container">
    <h1>PeeKaboo</h1>
    <form id="searchForm">
      <input type="text" id="searchInput" name="q" placeholder="Enter your query..." required>
      <button type="submit">EXECUTE</button>
    </form>
    <div id="suggestions"></div>
    <div id="results"></div>
    <div id="summary"></div> <!-- Summary div for clear separation -->
    <div id="metadata"></div>
    <footer>
      &copy; 2024 PeeKaboo | Powered by Illuminati
    </footer>
  </div>

  <script>
    document.getElementById('searchForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const query = document.getElementById('searchInput').value;
      const results = document.getElementById('results');
      const summary = document.getElementById('summary');
      const metadata = document.getElementById('metadata');

      results.innerHTML = 'Processing query...';
      summary.textContent = '';
      metadata.textContent = '';

      fetch(`search.php?q=${encodeURIComponent(query)}`)
        .then(response => response.json()) // Read the response as JSON
        .then(data => {
          // Clear previous results
          results.innerHTML = '';
          
          // Process and display images
          if (data.images && data.images.length > 0) {
            data.images.forEach(image => {
              const img = document.createElement('img');
              img.src = image.url;
              img.alt = 'Image';
              img.style.width = 'auto';  // Adjust width dynamically
              img.style.flex = '1 1 auto'; // Adjust flex properties for fitting
              results.appendChild(img);
            });
          } else {
            results.textContent = 'No images found.';
          }

          // Process and display summary
          if (data.summary) {
            summary.innerHTML = `<p>${data.summary}</p>`;
          } else {
            summary.innerHTML = '<p>No summary available.</p>';
          }

          // Process and display metadata
          if (data.metadata) {
            metadata.textContent = `Query: ${data.metadata.query}\nModel: ${data.metadata.model}\nDuration: ${data.metadata.duration.total}`;
          }
        })
        .catch(error => {
          console.error('Error:', error);
          results.textContent = `An error occurred while processing your query: ${error.message}`;
        });
    });

    const questions = [
      "What's new in old tech?",
      "How to debug life?",
      "Why is retro so cool?",
      "Best 8-bit music?",
      "Time travel theories?"
    ];

    const suggestionsHtml = questions.map(q => `<span class="question">${q}</span>`).join('');
    document.getElementById('suggestions').innerHTML = suggestionsHtml;

    document.querySelectorAll('.question').forEach(q => {
      q.addEventListener('click', function() {
        document.getElementById('searchInput').value = this.textContent;
      });
    });
  </script>
</body>
</html>
